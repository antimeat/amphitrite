<h1>CGI Script for Wave Data Partitioning retrieval from database</h1>
<hr>
<h2>Overview</h2>
<hr>
<p>This CGI script, provides a simple interface for managing and retrieving wave data. It offers functionalities like listing sites, fetching specific wave table data, and handling exclusion lists, both in HTML and JSON formats.</p>
<h2>Features</h2>
<hr>
<ul>
<li>List all sites as links in an HTML table format.</li>
<li>Provide database checks and return results in HTML.</li>
<li>Return site configurations and exclusion lists in JSON format.</li>
<li>Fetch wave table data for specific sites and run times.</li>
</ul>
<h2>Usage</h2>
<hr>
<p>The script can be accessed via HTTP requests with specific parameters:</p>
<h3>Endpoints and Parameters</h3>
<ul>
<li><code class="notranslate">?get=list_html</code> - Lists all sites as HTML links.</li>
<li><code class="notranslate">?get=database</code> - Displays database entries in HTML format.</li>
<li><code class="notranslate">?get=list_json</code> - Lists all sites and data in JSON format.</li>
<li><code class="notranslate">?get=exclusion</code> - Lists exclusion sites in JSON format.</li>
<li><code class="notranslate">?get=site&amp;site_name=[name]&amp;run_time=[time]</code> - Fetches data for a specific site and run time.</li>
</ul>
<h3>Examples</h3>
<ul>
<li>
<p><strong>List all sites in HTML</strong>:<br>
<code class="notranslate">url http://wa-vw-er/webapps/er_ml_projects/davink/amphitrite/api.cgi?get=list_html</code></p>
<h4>returns:</h4>
<table role="table">
<thead>
<tr>
<th align="center">Forecast site</th>
<th align="center">Auswave table</th>
<th align="center">Partitions</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">BHP - Pyrenees</td>
<td align="center">Pyrenees</td>
<td align="center">[0.001, 9.0], [9.0, 40.0]</td>
</tr>
<tr>
<td align="center">Boskalis - Dampier 7 Days</td>
<td align="center">Dampier_Po</td>
<td align="center">[0.001, 9.0], [9.0, 40.0]</td>
</tr>
<tr>
<td align="center">Boskalis - Scarborough 7 Days</td>
<td align="center">Scarb_new</td>
<td align="center">[0.001, 9.0], [9.0, 40.0]</td>
</tr>
<tr>
<td align="center">Chevron - Gorgon</td>
<td align="center">Gorgon</td>
<td align="center">[0.001, 10.0], [10.0, 40.0]</td>
</tr>
<tr>
<td align="center">...</td>
<td align="center">...</td>
<td align="center">...</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>List entries in database</strong>:<br>
<code class="notranslate">url http://wa-vw-er/webapps/er_ml_projects/davink/amphitrite/api.cgi?get=database</code></p>
<h4>returns:</h4>
<table role="table">
<thead>
<tr>
<th align="center">sites</th>
<th align="center">table</th>
<th align="center">partitions</th>
<th align="center">run_times</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">BHP - Pyrenees</td>
<td align="center">Pyrenees</td>
<td align="center">[0.001, 9.0], [9.0, 40.0]</td>
<td align="center">24/0124/12</td>
</tr>
<tr>
<td align="center">Boskalis - Dampier 7 Days</td>
<td align="center">Dampier_Po</td>
<td align="center">[0.001, 9.0], [9.0, 40.0]</td>
<td align="center">24/0124/00</td>
</tr>
<tr>
<td align="center">Boskalis - Scarborough 7 Days</td>
<td align="center">Scarb_new</td>
<td align="center">[0.001, 9.0], [9.0, 40.0]</td>
<td align="center">24/0123/12</td>
</tr>
<tr>
<td align="center">Chevron - Gorgon</td>
<td align="center">Gorgon</td>
<td align="center">[0.001, 10.0], [10.0, 40.0]</td>
<td align="center">24/0123/00</td>
</tr>
<tr>
<td align="center">...</td>
<td align="center">...</td>
<td align="center">...</td>
<td align="center">...</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>List sites in json</strong>:<br>
<code class="notranslate">url http://wa-vw-er/webapps/er_ml_projects/davink/amphitrite/api.cgi?get=list_json</code></p>
<h4>returns:</h4>
<pre class="notranslate"><code class="notranslate">{
    "BHP - Pyrenees": {
        "table": "Pyrenees",
        "parts": [
            [
                0.001,
                9
            ],
            [
                9,
                40
            ]
        ]
    },
    ...,
    "Woodside - Dampier Port DPS1 10 days": {
        "table": "Dampier_Po",
        "parts": [
            [
                0.001,
                9
            ],
            [
                9,
                40
            ]
        ]
    }
}
</code></pre>
</li>
<li>
<p><strong>List exclusion sites in json</strong>:<br>
<code class="notranslate">url http://wa-vw-er/webapps/er_ml_projects/davink/amphitrite/api.cgi?get=exclusion</code></p>
<h4>returns:</h4>
<pre class="notranslate"><code class="notranslate">{
    "Anglogold - Tropicana": {
        "name": "Anglogold - Tropicana"
    },
    "Santos - Van Gogh 4 days": {
        "name": "Santos - Van Gogh 4 days"
    },
    "Woodside - Logistics Learmonth 7 days": {
        "name": "Woodside - Logistics Learmonth 7 days"
    },
    "Chevron - Wheatstone Platform AFS": {
        "name": "Chevron - Wheatstone Platform AFS"
    },
    "Chevron Barrow Island AFS ML ext": {
        "name": "Chevron Barrow Island AFS ML ext"
    },
    "Woodside - Logistics Karratha 7 days": {
        "name": "Woodside - Logistics Karratha 7 days"
    },
    "Chevron - North Whites Beach": {
        "name": "Chevron - North Whites Beach"
    }
}
</code></pre>
</li>
<li>
<p><strong>Get Specific Site Data in JSON</strong>:<br>
<code class="notranslate">url http://wa-vw-er/webapps/er_ml_projects/davink/amphitrite/api.cgi?get=site&amp;site_name=Woodside - Scarborough 10 Days&amp;run_time=2024010112</code></p>
<h4>returns</h4>
<pre class="notranslate"><code class="notranslate">### AUSWAVE Partition Forecast ###
# Location:  Woodside - Scarborough 10 Days
# Table:  Scarb_new
# StartTime: 1706097600
# StartUTC:  20240124 1200
# Partitions:  [0.001, 9.0], [9.0, 40.0]
# Fields:    time[hrs], time[UTC], time[WST], wind_dir[degrees], wind_spd[kn], seasw_ht[m], seasw_dir[degree], seasw_pd[s], sea_ht[m], sea_dir[degree], sea_pd[s], sw1_ht[m], sw1_dir[degree], sw1_pd[s]
###
000,  2024-01-24 12:00,  2024-01-24 20:00,  201,  19,  3.02,  204,  9,   2.59,  204,  9,  1.55,  204,  17
001,  2024-01-24 13:00,  2024-01-24 21:00,  203,  19,  2.97,  204,  9,   2.54,  204,  9,  1.53,  204,  17
002,  2024-01-24 14:00,  2024-01-24 22:00,  204,  19,  2.93,  204,  9,   2.5,   204,  9,  1.52,  204,  17
003,  2024-01-24 15:00,  2024-01-24 23:00,  206,  19,  2.89,  204,  9,   2.46,  204,  9,  1.5,   204,  17
</code></pre>
</li>
</ul>
<h2>Logging</h2>
<hr>
<p>Errors are logged to <a href="http://wa-vw-er/webapps/er_ml_projects/davink/amphitrite/api.log" rel="nofollow">api.log</a>. Ensure the log file is writable by the web server.</p>
<h2>Author</h2>
<hr>
<p>Daz Vink: <a href="mailto:daz.vink@bom.gov.au">daz.vink@bom.gov.au</a></p>