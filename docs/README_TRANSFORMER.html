<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Amphitrite swell table transformation</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: 1;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="github-markdown.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Amphitrite swell table transformation</h1>
</header>
<p>This package sits under Amphitrite. It retrieves the swell partition
tables stored in the Amphitrite database and applies a transformation.
Table output is used by Amphitrite on demand API. Output is also saved
in <code>csv</code> format for ingesting to Vulture, and html format for
view.</p>
<h2 id="features">Features</h2>
<ul>
<li>Dashboard for configuration and interogation of the configs and the
output.</li>
<li>Applies transformations based on user-defined parameters for window
angles, multiplier, and attenuation.</li>
<li>Outputs modified transformed swell tables to html and csv, further
used for ingesting to Vulture and Amphitrite.</li>
</ul>
<h2 id="usage">Usage</h2>
<p>The transformer execution script sits under the root directory of the
Amphitrite package</p>
<ul>
<li><code>run_transformer.py</code></li>
</ul>
<h3 id="command-line-arguments">Command Line Arguments</h3>
<ul>
<li><code>--all</code>: If used, generate all sites output from config
file (default: not used)</li>
<li><code>--siteName</code>: The name of the site (default: "Dampier
Salt - Cape Cuvier 7 days").</li>
<li><code>--theta_split</code>: The angle that splits theat_1 and
theta_2 (default: 90)</li>
<li><code>--theta_1</code> 1st angle for direction transformation
(default: 262)</li>
<li><code>--theta_2</code>: 2nd angle for direction transformation
(default: 20)</li>
<li><code>--multi_short</code>: Multiplier for short period wave heights
(default: 1.0).</li>
<li><code>--multi_long</code>: Multiplier for long period wave heights
(default: 1.0).</li>
<li><code>--attenuation</code>: Attenuation factor for the wave periods
(default: 1.0).</li>
<li><code>--thresholds</code>: 3 comma-separated threshold values for
significant wave heights (default: "0.3,0.2,0.15").</li>
<li><code>--run_time</code>: Optionally pass a run Time: YYYYMMDDHH
(default: None)</li>
<li><code>--notrans</code>: If used, Transformed=False (default: not
used)</li>
<li><code>--nosave</code>: If used, dont save the file to disk (default:
not used)</li>
</ul>
<h3 id="running-the-script">Running the Script</h3>
<p>Run transformer on an indivual site</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./run_transformer.py</span> <span class="at">--siteName</span> <span class="st">&quot;Dampier Salt - Cape Cuvier&quot;</span> <span class="at">--theta_split</span> 90 <span class="at">--theta_1</span> 260 <span class="at">--theta_2</span> 020 <span class="at">--multi_short</span> 0.7 <span class="at">--multi_long</span> 1.0 <span class="at">--attenuation</span> 1.0 <span class="at">--thresholds</span> <span class="st">&quot;0.3,0.2,0.15&quot;</span></span></code></pre></div>
<p>To execute transformation of all configured sites</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./run_transformer.py</span> <span class="at">--all</span></span></code></pre></div>
<h2 id="configuration">Configuration</h2>
<p>Edit <code>transformer_configs.py</code> to set base directories or
other global settings.</p>
<h2 id="output">Output</h2>
<p>The script generates a CSV file with the transformed wave data in the
specified output directory. It also prints an HTML table to the console
for quick review. HTML output now going to the Gerling Hanson map for
visulalisation</p>
<h3 id="file-descriptions">File Descriptions</h3>
<p><strong>api.cgi</strong>:</p>
<ul>
<li>CGI script for the API.</li>
</ul>
<p><strong>save_transformer_config</strong>:</p>
<ul>
<li>Script to handle saving editied transform configuration data from
the dashboard to a config text file that is used by the
transformer.</li>
</ul>
<p><strong>sites.py</strong>:</p>
<ul>
<li>Script to return active Ofcast sites.</li>
</ul>
<p><strong>transform.py</strong>:</p>
<ul>
<li>Module that contains the main Transfrom class</li>
</ul>
<p><strong>transformer_configs.py</strong>:</p>
<ul>
<li>Module used for site configuration paths</li>
</ul>
<p><strong>transformer_site_configs.txt</strong>:</p>
<ul>
<li>Text file containing the config parameters</li>
</ul>
<p><strong>html/</strong>:</p>
<ul>
<li>Dashboard php and config files</li>
</ul>
<p><strong>docs/</strong>:</p>
<ul>
<li>Documentation kept here</li>
</ul>
<h2 id="author">Author</h2>
<p>Daz Vink: <a
href="mailto:daz.vink@bom.gov.au">daz.vink@bom.gov.au</a></p>
</body>
</html>
